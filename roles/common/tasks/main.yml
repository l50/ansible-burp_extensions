---
- name: Create extensions directory
  file:
   path: "{{extension_directory}}"
   state: directory

- name: Create dependencies directory
  file:
   path: "{{dep_dir}}"
   state: directory

- name: Get jython standalone jar
  get_url:
   url: "http://search.maven.org/remotecontent?filepath=org/python/jython-standalone/{{jython_version}}/jython-standalone-{{jython_version}}.jar"
   dest: "{{dep_dir}}/jython-standalone-{{jython_version}}.jar"

- name: Keep burp extensions up-to-date
  cron:
   name: "Wipe and reload the burpExtensions directory every 6 hours"
   hour: "*/16"
   job: "mv {{extension_directory}} {{extension_directory}}.bak; {{ansible_playbook_bin}} {{ansible_workspace}}/site.yml -vvv; if [[ -d {{extension_directory}} ]]; then rm -rf {{extension_directory}}.bak; else cp -r {{extension_directory}}.bak {{extension_directory}}; fi"
  when: destroy_rebuild
