---
- name: Create extensions directory
  file:
   path: "{{extension_directory}}"
   state: directory

- name: Create dependencies directory
  file:
   path: "{{dep_dir}}"
   state: directory

- name: Get jython standalone jar
  get_url:
   url: "http://search.maven.org/remotecontent?filepath=org/python/jython-standalone/{{jython_version}}/jython-standalone-{{jython_version}}.jar"
   dest: "{{dep_dir}}/jython-standalone-{{jython_version}}.jar"

- name: Keep burp extensions up-to-date
  cron:
   name: "Wipe and reload the burpExtensions directory every 6 hours"
   hour: "*/16"
   job: "rm -rf {{extension_directory}}; cd {{ansible_workspace}}; if ! out=`ansible-playbook site.yml`; then echo $out; fi"
  when: destroy_rebuild
